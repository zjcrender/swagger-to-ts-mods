# æ¬¢è¿ä½¿ç”¨ swagger-to-ts-mods ğŸ‘‹

![Version](https://img.shields.io/badge/version-0.0.1-blue.svg?cacheSeconds=2592000)
[![Documentation](https://img.shields.io/badge/documentation-yes-brightgreen.svg)](doc)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](#)

ä¸­æ–‡æ–‡æ¡£ | [English](./README-en.MD)

`swagger-to-ts-mods` æ ¹æ® [swaggeræ–‡æ¡£](https://swagger.io/specification/v2/)ç”Ÿæˆtypescriptç±»å‹å£°æ˜åŠapiè°ƒç”¨å‡½æ•°

## å®‰è£…

```shell
# ä½¿ç”¨ npm
npm install swagger-to-ts-mods

# ä½¿ç”¨ yarn
yarn add swagger-to-ts-mods
```

## ä½¿ç”¨

```shell
# ç”Ÿæˆé…ç½®æ–‡ä»¶
$ s2t setup

# ç”Ÿæˆç±»å‹å£°æ˜åŠapiå‡½æ•°
$ s2t generate

# æŸ¥çœ‹è¯´æ˜
$ s2t [command] -h
```

## ç”Ÿæˆç¤ºä¾‹

### API.d.ts

```typescript
declare namespace API {
  namespace User {
    interface Exception {
      cause?: Throwable;
      localizedMessage?: string;
      message?: string;
      stackTrace?: StackTraceElement[];
      suppressed?: Throwable[];
    }
    interface RestVo {
      code?: number;
      data?: { ... };
      exception?: Exception;
      message?: string;
    }
    /** login */
    namespace postAuthsLogin {
      type Query = {
        /** checkcode */
        code?: string;
        /** phone */
        mobile?: string;
        /** password */
        password?: string;
        /** account */
        username?: string;
      };

      type Response = RestVo;
    }
  }
  
  namespace File { ... }
  ...
}
```

### some-operation.ts

e.g. `postAuthsLogin.ts`

```typescript
import uRequest from "@/services";

import Inter = API.User.postAuthsLogin;

/** login */
export function postAuthsLogin(query: Inter.Query): Promise<Inter.Response> {
  return uRequest<Inter.Response>("/api/v1/auths/login", {
    method: "post",
    params: query,
  });
}
```



## å‘½ä»¤

### `$ s2t setup [outputPath]`

ç”Ÿæˆé…ç½®æ–‡ä»¶

| å‚æ•°   | é»˜è®¤å€¼                 |æ˜¯å¦å¿…å¡«| è¯´æ˜         |
|------|---------------------|---|------------|
| outputPath | "./s2t.config.json" |å¦| æŒ‡å®šé…ç½®æ–‡ä»¶è¾“å‡ºåœ°å€ |

### `$ s2t generate [configPath]`
æ ¹æ®é…ç½®æ–‡ä»¶ç”Ÿæˆç›®æ ‡æ–‡ä»¶

| å‚æ•°   | é»˜è®¤å€¼                 |æ˜¯å¦å¿…å¡«| è¯´æ˜         |
|------|---------------------|---|------------|
| configPath | "./s2t.config.json" |å¦| ç”¨äºæŒ‡å®šé…ç½®æ–‡ä»¶åœ°å€ |

## é…ç½®æ–‡ä»¶

### s2t.config.json

| key     | ç±»å‹            | é»˜è®¤å€¼             | æ˜¯å¦å¿…å¡«  | è¯´æ˜       |
|:--------|:--------------|:----------------|-------|:---------|
| request | [RequestConfig](#RequestConfig) | è§[RequestConfig](#RequestConfig) | æ˜¯     | é€šç”¨apiè¯·æ±‚è®¾ç½® |
| handleUnknownType  | unknown  \|  generic \| any | unknown | å¦ | å¦‚ä½•å¤„ç†æœªçŸ¥ç±»å‹ ï¼ˆæš‚æœªå®ç°ï¼‰ |
| outputDir | Path | "./services" | å¦ | ç”Ÿæˆæ–‡ä»¶çš„ç›®å½• |
| templateDir | Path | [å†…ç½®](./src/templates) | å¦ | ç”Ÿæˆç±»å‹å£°æ˜åŠapiå‡½æ•°æ—¶çš„æ¨¡æ¿æ–‡ä»¶ç›®å½• |
| origins  | [OriginConfig](#OriginConfig)[] | æ—     | æ˜¯ | æŒ‡å®šswaggeræ–‡æ¡£åœ°å€æ¥æº |



### OriginConfig

| key        | ç±»å‹                           | é»˜è®¤å€¼                            | æ˜¯å¦å¿…å¡« | è¯´æ˜                     |
| :--------- | :----------------------------- | :-------------------------------- | -------- | :----------------------- |
| origin     | string                         | æ—                                 | æ˜¯       | swaggeræ–‡æ¡£åœ°å€          |
| originName | string                         | æ—                                 | æ˜¯       | æŒ‡å®šè¯¥æ–‡æ¡£åç§°           |
| request    | [RequestConfig](RequestConfig) | è§[RequestConfig](#RequestConfig) | å¦       | ä¸ºè¯¥æ–‡æ¡£æŒ‡å®šç‰¹æ®Šè¯·æ±‚è®¾ç½® |



### RequestConfig

ç”Ÿæˆapiå‡½æ•°æ—¶æŒ‡å®šåŸºç±»å‡½æ•°çš„å¼•å…¥æ–¹å¼

å¦‚ï¼š `import ${methodName} from "${filePath}"`

| key        | ç±»å‹    | é»˜è®¤å€¼      | æ˜¯å¦å¿…å¡« | è¯´æ˜                 |
| :--------- | :------ | :---------- | -------- | :------------------- |
| filePath   | Path    | "@/request" | å¦       | æŒ‡å®šæœ¬åœ°æ¥å£è°ƒç”¨å‡½æ•° |
| methodName | string  | request     | å¦       | æŒ‡å®šå¯¼å‡ºçš„å‡½æ•°å     |
| default    | boolean | true        | å¦       | æ–¹æ³•æ˜¯å¦ä¸ºé»˜è®¤å¯¼å‡º   |



### æ¨¡æ¿æ–‡ä»¶

ä½¿ç”¨[mustache](https://github.com/mustache/mustache.github.com)ä½œä¸ºæ¸²æŸ“å¼•æ“

| æ¨¡æ¿               | å†…å®¹                                       | è¯´æ˜         |
| :----------------- | :----------------------------------------- | :----------- |
| API.d.mustache     | [å†…ç½®](./src/templates/API.d.mustache)     | å£°æ˜æ–‡ä»¶æ¨¡æ¿ |
| operation.mustache | [å†…ç½®](./src/templates/operation.mustache) | apiæ¨¡æ¿      |



## TODOS:

- [ ] æ”¯æŒ$refä¸­è¿œç¨‹æ–‡æ¡£çš„è§£æ
- [ ] å¤„ç†æœªçŸ¥ç±»å‹æ—¶ï¼Œæ”¯æŒæ³›å‹
